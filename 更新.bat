@echo off
chcp 65001 >nul

echo ========================================
echo     ğŸš€ æ­£åœ¨åŒæ­¥ Astro åšå®¢æºç ...
echo ========================================

:: 1. ä¿®å¤ç›®å½•æƒé™ (å·²ç»æ ¹æ®ä½ çš„é¡¹ç›®è·¯å¾„æ›´æ–°)
git config --global --add safe.directory "%~dp0"

:: 2. è¿™é‡Œçš„ Astro ä¸éœ€è¦æœ¬åœ° buildï¼ŒCloudflare ä¼šåœ¨äº‘ç«¯å¤„ç†
:: å¦‚æœä½ æƒ³åœ¨æ¨é€å‰æ£€æŸ¥æœ¬åœ°æ˜¯å¦æœ‰è¯­æ³•é”™è¯¯ï¼Œå¯ä»¥å–æ¶ˆä¸‹é¢è¿™ä¸€è¡Œçš„æ³¨é‡Šï¼š
:: call pnpm run build

:: 3. æäº¤æ›´æ”¹
echo [æ­£åœ¨è®°å½•æ›´æ”¹...]
git add .
:: ä½¿ç”¨ %date% å’Œ %time% ç”Ÿæˆæäº¤ä¿¡æ¯
git commit -m "Update Blog: %date:~0,10% %time:~0,5%"

:: 4. æ¨é€è‡³ GitHub
echo [æ­£åœ¨æ¨é€åˆ° GitHubï¼ŒCloudflare å°†è‡ªåŠ¨åŒæ­¥...]
git push origin main

echo ========================================
echo     âœ… åŒæ­¥å®Œæˆï¼
echo     æç¤ºï¼šè¯·å‰å¾€ Cloudflare æ§åˆ¶å°æŸ¥çœ‹æ„å»ºè¿›åº¦ã€‚
echo ========================================

:: 5. å€’è®¡æ—¶å¹¶é€€å‡º
timeout /t 5 /nobreak

exit